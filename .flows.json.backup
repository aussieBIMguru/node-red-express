[{"id":"18af1902.b21ed7","type":"tab","label":"Authentication","disabled":false,"info":""},{"id":"f471f5df.f04278","type":"tab","label":"Data Management API","disabled":false,"info":""},{"id":"4a045ae1.735204","type":"tab","label":"Sharepoint","disabled":false,"info":""},{"id":"54fd5e11.cf884","type":"subflow","name":"Forge 2legged","info":"","in":[{"x":200,"y":120,"wires":[{"id":"19ac201b.19c65"}]}],"out":[{"x":600,"y":160,"wires":[{"id":"f7307bcc.b4c638","port":0}]}]},{"id":"6f74f178.db583","type":"function","z":"18af1902.b21ed7","name":"Authorise (app)","func":"const clientId = global.get('FORGE_CLIENT_ID');\nvar clientSecret = global.get('FORGE_CLIENT_SECRET');\nconst scopes = global.get('FORGE_AUTH_SCOPES');\n\nmsg.url = 'https://developer.api.autodesk.com/authentication/v1/authenticate';\nmsg.headers = {\n    'Content-Type': 'application/x-www-form-urlencoded'\n};\nmsg.payload = {\n    client_id: clientId,\n    client_secret: clientSecret,\n    grant_type: 'client_credentials',\n    scope: scopes.join(' ')\n};\n\nreturn msg;\n","outputs":1,"noerr":0,"x":320,"y":120,"wires":[["b641ca9f.b6fad8"]]},{"id":"9683d968.d85ce8","type":"inject","z":"18af1902.b21ed7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":120,"wires":[["6f74f178.db583"]]},{"id":"b641ca9f.b6fad8","type":"http request","z":"18af1902.b21ed7","name":"","method":"POST","ret":"obj","url":"","tls":"","x":510,"y":120,"wires":[["90a8ba8d.42d2a8"]]},{"id":"ef6e49ba.748818","type":"comment","z":"18af1902.b21ed7","name":"Forge - 2 legged","info":"","x":160,"y":80,"wires":[]},{"id":"b09c0026.c831e","type":"inject","z":"18af1902.b21ed7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":240,"wires":[["5a71baa4.3a4a94"]]},{"id":"5a71baa4.3a4a94","type":"function","z":"18af1902.b21ed7","name":"Log oauth URL (user)","func":"const clientId = global.get('FORGE_CLIENT_ID');\nconst callbackUrl = global.get('FORGE_CALLBACK_URL');\nconst scopes = global.get('FORGE_AUTH_SCOPES');\n\nmsg.payload = `https://developer.api.autodesk.com/authentication/v1/authorize?response_type=code&client_id=${clientId}&redirect_uri=${encodeURIComponent(callbackUrl)}&scope=${scopes.join('%20')}`\n\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":240,"wires":[["cd4b9f6e.9ff8e"]]},{"id":"6d3ff910.372dd8","type":"function","z":"18af1902.b21ed7","name":"Paste access code (user)","func":"// PASTE code here:\nvar code = 'NBbYNNERMTrb_5aWypWIjWyAQ15ldKQA4ZLNgxwc';\n// END\n\nvar clientId = global.get('FORGE_CLIENT_ID');\nvar clientSecret = global.get('FORGE_CLIENT_SECRET');\nvar callbackUrl = global.get('FORGE_CALLBACK_URL');\n\nmsg.url = 'https://developer.api.autodesk.com/authentication/v1/gettoken';\nmsg.method = \"POST\"\nmsg.payload = {\n    client_id: clientId,\n    client_secret: clientSecret,\n    grant_type: 'authorization_code',\n    code,\n    redirect_uri: callbackUrl\n};\nmsg.headers = {\n    'Content-Type': 'application/x-www-form-urlencoded'\n};\nreturn msg;\n","outputs":1,"noerr":0,"x":350,"y":300,"wires":[["5ac3dde2.bf31d4"]]},{"id":"c6f08be3.b6b758","type":"inject","z":"18af1902.b21ed7","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":300,"wires":[["6d3ff910.372dd8"]]},{"id":"5ac3dde2.bf31d4","type":"http request","z":"18af1902.b21ed7","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":570,"y":300,"wires":[["1bca0910.d657f7"]]},{"id":"1bca0910.d657f7","type":"function","z":"18af1902.b21ed7","name":"Set access token","func":"console.log('BIM360 user access token:', msg.payload);\n\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":300,"wires":[["1a69f108.0a41df"]]},{"id":"ab11bc44.66ff","type":"comment","z":"18af1902.b21ed7","name":"BIM360 - 3 legged","info":"","x":170,"y":200,"wires":[]},{"id":"cd4b9f6e.9ff8e","type":"debug","z":"18af1902.b21ed7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":530,"y":240,"wires":[]},{"id":"1a69f108.0a41df","type":"debug","z":"18af1902.b21ed7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":970,"y":300,"wires":[]},{"id":"64edaab0.db2af4","type":"comment","z":"18af1902.b21ed7","name":"Step 1.","info":"Generate the URL that you Application will make requests to perform the first leg of three-legged authentication.\n\nCopy the [https://pasteboard.co/IBqsjWJ.png](code) value and prepare for step 2.\n\n","x":690,"y":240,"wires":[]},{"id":"f3601f8.18e4fe","type":"comment","z":"18af1902.b21ed7","name":"Step 2.","info":"Exchange the code for the access_token\n\nIn the .bl-config.json file, copy the `access_token` to the property \"FORGE_ACCESS\"  \n\nThis is the value that your application will send with future requests on behalf of this user.\n","x":1130,"y":300,"wires":[]},{"id":"16b8a627.7ef3aa","type":"function","z":"f471f5df.f04278","name":"Get hub","func":"const accessToken = global.get('FORGE_ACCESS');\n\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\nmsg.url = 'https://developer.api.autodesk.com/project/v1/hubs';\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":80,"wires":[["2693ad60.91e412","1a61c8fc.b4a897"]]},{"id":"9ff77420.5662b8","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":80,"wires":[["16b8a627.7ef3aa"]]},{"id":"2693ad60.91e412","type":"http request","z":"f471f5df.f04278","name":"","method":"GET","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":490,"y":80,"wires":[["98a31843.f69858","71c031a3.9a445"]]},{"id":"98a31843.f69858","type":"function","z":"f471f5df.f04278","name":"Log hub ID","func":"// console.log('msg.payload', JSON.stringify(msg.payload));\nconst listHubs = msg.payload.data.map(item => ({\n    id: item.id,\n    name: item.attributes.name,\n}))\n\nmsg.payload = listHubs\n\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":80,"wires":[["d551ad2a.d82c3"]]},{"id":"490b27ef.2e9068","type":"function","z":"f471f5df.f04278","name":"List projects","func":"const accessToken = global.get('FORGE_ACCESS')\nconst accountId = global.get('FORGE_HUB_ID');\n\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nmsg.url = `https://developer.api.autodesk.com/project/v1/hubs/${accountId}/projects`\n\n// console.log(msg.headers, msg.url);\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":140,"wires":[["f37795d1.c81658"]]},{"id":"52a17906.bfbb58","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":140,"wires":[["490b27ef.2e9068"]]},{"id":"f37795d1.c81658","type":"http request","z":"f471f5df.f04278","name":"","method":"GET","ret":"obj","url":"","tls":"","x":490,"y":140,"wires":[["b370a625.98c398"]]},{"id":"b370a625.98c398","type":"function","z":"f471f5df.f04278","name":"Log projects","func":"console.log(msg.payload)\n\nvar listProjects = msg.payload.data.map(item => ({\n    id: item.id,\n    name: item.attributes.name,\n    containerId: item.relationships.issues ? item.relationships.issues.data.id : undefined,\n    rootFolder: item.relationships.rootFolder ? item.relationships.rootFolder.data.id : undefined,\n}));\n\nmsg.payload = listProjects \n\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":140,"wires":[["8e8d23d1.c9aad"]]},{"id":"d551ad2a.d82c3","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":80,"wires":[]},{"id":"8e8d23d1.c9aad","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":140,"wires":[]},{"id":"b806efc7.fc92f","type":"function","z":"f471f5df.f04278","name":"Get project Details","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst hub_id = global.get('FORGE_HUB_ID');\n\nmsg.url = `https://developer.api.autodesk.com/project/v1/hubs/${hub_id}/projects/${project_id}`\nmsg.method = \"GET\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":1100,"wires":[["20f30f93.4339c"]]},{"id":"51c782cf.46e3dc","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1100,"wires":[["b806efc7.fc92f"]]},{"id":"20f30f93.4339c","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":530,"y":1100,"wires":[["521e6447.0384ac"]]},{"id":"521e6447.0384ac","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":1100,"wires":[]},{"id":"5dd3345f.1efa9c","type":"function","z":"f471f5df.f04278","name":"Get root folder Details","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_ROOT_FOLDER_ID');\n\nmsg.url = `https://developer.api.autodesk.com/data/v1/projects/${project_id}/folders/${folder_id}/contents`\nmsg.method = \"GET\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":200,"wires":[["2a182c8f.e20ca4"]]},{"id":"304d3c7f.d089e4","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":200,"wires":[["5dd3345f.1efa9c"]]},{"id":"2a182c8f.e20ca4","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":570,"y":200,"wires":[["c7e095bb.a33038"]]},{"id":"c7e095bb.a33038","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":200,"wires":[]},{"id":"76a63937.474758","type":"function","z":"f471f5df.f04278","name":"POST job","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_FOLDER_ID');\nconst item_id = global.get('FORGE_ITEM_SOURCE_URN')\n\nmsg.url = `https://developer.api.autodesk.com/modelderivative/v2/designdata/job`\nmsg.method = \"POST\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken,\n    'Content-Type': 'application/json'\n};\nmsg.payload = {\n    input: {\n        'urn': item_id\n    },\n    output: {\n        formats: [\n            {\n               \"type\": \"svf\",\n               \"views\": [\n                 \"2d\",\n                 \"3d\"\n               ]\n             }\n        ]\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":380,"wires":[["64ed26e1.04dbb8"]]},{"id":"917c171.9952be8","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":380,"wires":[["76a63937.474758"]]},{"id":"f7a11b10.2a17f8","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":650,"y":380,"wires":[["ec156e25.5b80d"]]},{"id":"ec156e25.5b80d","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":380,"wires":[]},{"id":"cfdf37a9.06bfb8","type":"function","z":"f471f5df.f04278","name":"Get urn thumbnail","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_FOLDER_ID');\nconst file_b64 = global.get('FORGE_FILE_URN_B64')\n\nmsg.url = `https://developer.api.autodesk.com/modelderivative/v2/designdata/${file_b64}/thumbnail`\nmsg.method = \"GET\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":1020,"wires":[["1a0e3fb.7d0b7c"]]},{"id":"3340fc21.e227f4","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1020,"wires":[["cfdf37a9.06bfb8"]]},{"id":"1a0e3fb.7d0b7c","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"bin","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":530,"y":1020,"wires":[["1da2925f.67874e","dfbb4787.92b4f8"]]},{"id":"1da2925f.67874e","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":830,"y":1020,"wires":[]},{"id":"dfbb4787.92b4f8","type":"file","z":"f471f5df.f04278","name":"","filename":"thumbnail.png","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":860,"y":1060,"wires":[[]]},{"id":"fb5dc872.8d9b58","type":"function","z":"f471f5df.f04278","name":"Get item Details","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_FOLDER_ID');\nconst item_id = global.get('FORGE_ITEM_ID')\n\nmsg.url = `https://developer.api.autodesk.com/data/v1/projects/${project_id}/items/${item_id}`\nmsg.method = \"GET\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":320,"wires":[["ac6aa8fd.20a488"]]},{"id":"29518e1c.44d5b2","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":320,"wires":[["fb5dc872.8d9b58"]]},{"id":"ac6aa8fd.20a488","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":530,"y":320,"wires":[["1e35b136.ff750f"]]},{"id":"1e35b136.ff750f","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":320,"wires":[]},{"id":"f0c85c85.3d706","type":"function","z":"f471f5df.f04278","name":"GET metadata (tbc)","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_FOLDER_ID');\nconst file_b64 = global.get('FORGE_FILE_URN_B64')\n\nmsg.url = `https://developer.api.autodesk.com/modelderivative/v2/designdata/${file_b64}/metadata`\nmsg.method = \"POST\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":980,"wires":[["951d5905.2db6c8"]]},{"id":"e7b46412.ac4958","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":980,"wires":[["f0c85c85.3d706"]]},{"id":"951d5905.2db6c8","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":530,"y":980,"wires":[["584ce256.737f7c"]]},{"id":"584ce256.737f7c","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":980,"wires":[]},{"id":"f207f67e.ba4f28","type":"function","z":"f471f5df.f04278","name":"GET manifest","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_FOLDER_ID');\nconst urn = global.get('FORGE_ITEM_DERIVATIVE_URN')\n\nmsg.url = `https://developer.api.autodesk.com/modelderivative/v2/designdata/${urn}/manifest`\nmsg.method = \"GET\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\nconsole.log(msg.url)\n\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":440,"wires":[["996acf4d.cdc57"]]},{"id":"cddebecf.5e213","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":440,"wires":[["f207f67e.ba4f28"]]},{"id":"996acf4d.cdc57","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":530,"y":440,"wires":[["77275a47.aedc14"]]},{"id":"77275a47.aedc14","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":440,"wires":[]},{"id":"b0ac5cbe.12d0b","type":"comment","z":"f471f5df.f04278","name":"Additional - Do not use","info":"","x":180,"y":940,"wires":[]},{"id":"90a8ba8d.42d2a8","type":"debug","z":"18af1902.b21ed7","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":690,"y":120,"wires":[]},{"id":"63a53dcf.b5d964","type":"function","z":"f471f5df.f04278","name":"Post buckets","func":"// https://forge.autodesk.com/en/docs/data/v2/reference/http/buckets-POST/\n\nconst accessToken = global.get('FORGE_ACCESS')\nconst clientId = global.get(\"FORGE_CLIENT_ID\")\n\nmsg.url = \"https://developer.api.autodesk.com/oss/v2/buckets\"\nmsg.method = \"POST\"\nmsg.headers = {\n    \"Authorization\": \"Bearer \" + accessToken,\n    \"Content-Type\": \"application/json\"\n}\n\nmsg.payload = {\n    bucketKey: \"amgen_bucket\",\n    authId: clientId,\n    access: \"full\",\n    policyKey: \"persistent\"\n    \n}\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":740,"wires":[["e38f21b7.54bc8"]]},{"id":"8a96ecf3.ab8d6","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":740,"wires":[["63a53dcf.b5d964"]]},{"id":"b285f4b7.ba1c68","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":730,"y":740,"wires":[]},{"id":"e38f21b7.54bc8","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":570,"y":740,"wires":[["b285f4b7.ba1c68"]]},{"id":"f7307bcc.b4c638","type":"function","z":"54fd5e11.cf884","name":"Set Global","func":"var newmsg = {}\n\nglobal.set(\"access_token\", msg.payload.access_token)\n\nnewmsg.payload = {\n    subflow: \"forge auth\",\n    statusCode: msg.statusCode,\n    access_token: msg.payload.access_token,\n    token_type: msg.payload.token_type,\n    expires_in: msg.payload.expires_in\n}\n\nreturn newmsg;","outputs":1,"noerr":0,"x":470,"y":160,"wires":[[]]},{"id":"19ac201b.19c65","type":"function","z":"54fd5e11.cf884","name":"","func":"var newmsg = {}\n\nvar client_id = \"O2txR3lna0BdlLIbobTBxo4fTyQSZxCm\"\nvar client_secret = \"F96PasfEPyyaIlxA\"\nvar grant_type = \"client_credentials\" // Must be client_credentials\nvar scope = \"code:all bucket:create bucket:read data:write data:read viewables:read\"\n\n\nnewmsg.payload = {}\nnewmsg.payload.client_id = client_id\nnewmsg.payload.client_secret = client_secret\nnewmsg.payload.grant_type = grant_type\nnewmsg.payload.scope = scope\nnewmsg.headers = {\n    \"Content-Type\" : \"application/x-www-form-urlencoded\"\n}\n\nreturn newmsg;","outputs":1,"noerr":0,"x":350,"y":120,"wires":[["4ee30d41.af60a4"]]},{"id":"4ee30d41.af60a4","type":"http request","z":"54fd5e11.cf884","name":"GetOauth2","method":"POST","ret":"obj","url":"https://developer.api.autodesk.com/authentication/v1/authenticate","tls":"","x":490,"y":120,"wires":[["f7307bcc.b4c638"]]},{"id":"e29faa96.9b2bf8","type":"function","z":"f471f5df.f04278","name":"Get sub folder Details","func":"const accessToken = global.get('FORGE_ACCESS')\nconst project_id = global.get('FORGE_PROJECT_ID')\nconst folder_id = global.get('FORGE_SUB_FOLDER_ID');\n\nmsg.url = `https://developer.api.autodesk.com/data/v1/projects/${project_id}/folders/${folder_id}/contents`\nmsg.method = \"GET\"\nmsg.headers = {\n    'Authorization': 'Bearer ' + accessToken\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":260,"wires":[["fbbcc390.b0e25"]]},{"id":"d1753f4e.fca27","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":260,"wires":[["e29faa96.9b2bf8"]]},{"id":"fbbcc390.b0e25","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":570,"y":260,"wires":[["75edd4be.d28c9c"]]},{"id":"75edd4be.d28c9c","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":260,"wires":[]},{"id":"64ed26e1.04dbb8","type":"base64","z":"f471f5df.f04278","name":"","action":"str","property":"payload.input.urn","x":480,"y":380,"wires":[["f7a11b10.2a17f8"]]},{"id":"71c031a3.9a445","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":670,"y":40,"wires":[]},{"id":"1a61c8fc.b4a897","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":40,"wires":[]},{"id":"219f3060.21caf","type":"function","z":"f471f5df.f04278","name":"Get buckets (2 legged)","func":"const accessToken = global.get('FORGE_ACCESS')\nconst clientId = global.get(\"FORGE_CLIENT_ID\")\n\nmsg.url = \"https://developer.api.autodesk.com/oss/v2/buckets\"\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Authorization\": \"Bearer \" + accessToken,\n    \"Content-Type\": \"application/json\"\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":800,"wires":[["713f9769.966998"]]},{"id":"a42ccd2.f01e53","type":"inject","z":"f471f5df.f04278","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":800,"wires":[["219f3060.21caf"]]},{"id":"cffeedc8.760a6","type":"debug","z":"f471f5df.f04278","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":730,"y":800,"wires":[]},{"id":"713f9769.966998","type":"http request","z":"f471f5df.f04278","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":570,"y":800,"wires":[["cffeedc8.760a6"]]},{"id":"c6a13ee3.07a37","type":"function","z":"4a045ae1.735204","name":"Generate Authorization URL","func":"const baseURL = global.get(\"SHAREPOINT_LOGIN_BASE_URL\")\nconst client_id = global.get(\"SHAREPOINT_CLIENT_ID\")\nconst response_type = global.get(\"SHAREPOINT_RESPONSE_TYPE\")\nconst uncoded_redirect_uri = global.get(\"SHAREPOINT_REDIRECT_URI\")\nconst response_mode = global.get(\"SHAREPOINT_RESPONSE_MODE\")\nconst scope = global.get(\"SHAREPOINT_SCOPE\")\nconst state = global.get(\"SHAREPOINT_STATE\")\n\nconst path = \"/oauth2/v2.0/authorize\" \nconst redirect_uri = encodeURIComponent(uncoded_redirect_uri)\n\n// log request url to debug tab\nmsg.payload = baseURL + path + \"?client_id=\" + client_id + \"&response_type=\" + response_type + \"&response_mode=\" + response_mode + \"&scope=\" + scope + \"&state=\" + state\n\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":140,"wires":[["9cc6c738.a91b28"]]},{"id":"203b2637.8ff67a","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":140,"wires":[["c6a13ee3.07a37"]]},{"id":"9cc6c738.a91b28","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":610,"y":140,"wires":[]},{"id":"8864d57a.7b0218","type":"http in","z":"4a045ae1.735204","name":"","url":"/api/sp/callback","method":"get","upload":false,"swaggerDoc":"","x":150,"y":80,"wires":[["cc674313.8cfb7","f3ef4abe.4fdd08"]]},{"id":"cc674313.8cfb7","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":470,"y":40,"wires":[]},{"id":"f08f8746.50b7f8","type":"function","z":"4a045ae1.735204","name":"Token endpoint","func":"const sharepoint_baseurl = global.get(\"SHAREPOINT_LOGIN_BASE_URL\")\nconst client_id = global.get(\"SHAREPOINT_CLIENT_ID\")\nconst scope = global.get(\"SHAREPOINT_SCOPE\")\nconst code = global.get(\"SHAREPOINT_CODE\")\nconst redirect_uri = global.get(\"SHAREPOINT_REDIRECT_URI\")\nconst grant_type = global.get(\"SHAREPOINT_GRANT_TYPE\")\nconst client_secret = global.get(\"SHAREPOINT_CLIENT_SECRET\")\n\nmsg.url = sharepoint_baseurl + \"/oauth2/v2.0/token\"\nmsg.method = \"POST\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\"\n}\nmsg.payload = {\n    \"client_id\": client_id,\n    \"scope\": scope, // \"user.read\"\n    \"code\": code,\n    \"redirect_uri\": redirect_uri,\n    \"grant_type\": grant_type,\n    \"client_secret\": client_secret\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":180,"wires":[["fd498afa.eb6938"]]},{"id":"b6d7e439.22e8d8","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":180,"wires":[["f08f8746.50b7f8"]]},{"id":"fd498afa.eb6938","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":550,"y":180,"wires":[["14e400e.d9324ff"]]},{"id":"14e400e.d9324ff","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload.access_token","targetType":"msg","x":790,"y":180,"wires":[]},{"id":"b4a17ae.0c20f88","type":"function","z":"4a045ae1.735204","name":"GET site root","func":"const base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\n\nmsg.url = `${base}/sites/root`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":880,"wires":[["d3b277b9.831a98"]],"info":"Access the default Drive (document library) for the given SharePoint site"},{"id":"4530118.6eaaaf","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":880,"wires":[["b4a17ae.0c20f88"]]},{"id":"d3b277b9.831a98","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":575,"y":880,"wires":[["79b7d15d.33e09"]]},{"id":"79b7d15d.33e09","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":735,"y":880,"wires":[]},{"id":"8a837332.12df","type":"function","z":"4a045ae1.735204","name":"GET site lists","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\n\nmsg.url = `${base}/sites/${sharepoint_tenant_url}/lists`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":300,"wires":[["2dc75386.2b6f1c"]],"info":"Access the default Drive (document library) for the given SharePoint site"},{"id":"65e8cc26.a351b4","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":300,"wires":[["8a837332.12df"]]},{"id":"2dc75386.2b6f1c","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":300,"wires":[["6f2b384e.99dca8"]]},{"id":"6f2b384e.99dca8","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":715,"y":300,"wires":[]},{"id":"b4e713a0.e7197","type":"function","z":"4a045ae1.735204","name":"GET items within list","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\nconst sharepoint_list_id = global.get(\"SHAREPOINT_LIST_ID\")\n\nmsg.url = `${base}/sites/${sharepoint_tenant_url}/lists/${sharepoint_list_id}/items`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":340,"wires":[["fb6cbebd.c7be"]],"info":"Access the default Drive (document library) for the given SharePoint site"},{"id":"116a6ab8.fef355","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":340,"wires":[["b4e713a0.e7197"]]},{"id":"fb6cbebd.c7be","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":340,"wires":[["5402837c.b441fc"]]},{"id":"5402837c.b441fc","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.value","targetType":"msg","x":755,"y":340,"wires":[]},{"id":"6ff0e9e9.65c748","type":"function","z":"4a045ae1.735204","name":"GET drives","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\nconst sharepoint_list_id = global.get(\"SHAREPOINT_LIST_ID\")\n\nconst siteId = global.get(\"SHAREPOINT_SITE_ID\")\n\nmsg.url = `${base}/sites/${siteId}/drives`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":580,"wires":[["685ea94c.ca8a48"]],"info":"Access the default Drive (document library) for the given SharePoint site"},{"id":"a1b753d8.0ee6f","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":580,"wires":[["6ff0e9e9.65c748"]]},{"id":"685ea94c.ca8a48","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":580,"wires":[["60eead52.ad7794"]]},{"id":"60eead52.ad7794","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":715,"y":580,"wires":[]},{"id":"f3ef4abe.4fdd08","type":"http response","z":"4a045ae1.735204","name":"","statusCode":"200","headers":{},"x":500,"y":80,"wires":[]},{"id":"6703d4cb.b2194c","type":"comment","z":"4a045ae1.735204","name":"Utility","info":"","x":130,"y":800,"wires":[]},{"id":"80755d2.ef02ba","type":"function","z":"4a045ae1.735204","name":"GET item","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\nconst sharepoint_list_id = global.get(\"SHAREPOINT_LIST_ID\")\n\n// const path2file = \"IFCSchependomlaan.ifc\"\n\nconst driveId = global.get(\"SHAREPOINT_DRIVE_ID\")\nconst itemId = global.get(\"SHAREPOINT_DRIVE_ITEM_ID\")\n\n// msg.url = `${base}/sites/${sharepoint_tenant_url}/lists/${sharepoint_list_id}/items/:${path2file}`\n\nmsg.url = `${base}/drives/${driveId}/items/${itemId}`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":660,"wires":[["add0ee48.d3d24"]],"info":"Access the default Drive (document library) for the given SharePoint site"},{"id":"81972eed.bcf19","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":660,"wires":[["80755d2.ef02ba"]]},{"id":"add0ee48.d3d24","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":660,"wires":[["c41835d0.fbaeb8","3903f679.23364a"]]},{"id":"c41835d0.fbaeb8","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":false,"console":true,"tostatus":false,"complete":"payload[\"@microsoft.graph.downloadUrl\"]","targetType":"msg","x":855,"y":660,"wires":[]},{"id":"4b4bc845.bb0248","type":"file","z":"4a045ae1.735204","name":"","filename":"file.png","appendNewline":true,"createDir":false,"overwriteFile":"true","encoding":"none","x":920,"y":720,"wires":[[]]},{"id":"287a2690.292a5a","type":"function","z":"4a045ae1.735204","name":"GET drive by Id","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\n\nconst driveId = global.get(\"SHAREPOINT_DRIVE_ID\")\n\nmsg.url = `${base}/drives/${driveId}`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":920,"wires":[["dd096130.ad9f3"]],"info":"List a site's drives:\nAccess the default Drive (document library) for the given SharePoint site\n\n=> Drive"},{"id":"6d36314a.b8862","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":920,"wires":[["287a2690.292a5a"]]},{"id":"dd096130.ad9f3","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":575,"y":920,"wires":[["f4e7fa89.bcfdb8"]]},{"id":"f4e7fa89.bcfdb8","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":735,"y":920,"wires":[]},{"id":"bad86abb.795d98","type":"function","z":"4a045ae1.735204","name":"GET root drive items","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\n\nconst driveId = global.get(\"SHAREPOINT_DRIVE_ID\")\n\nmsg.url = `${base}/drives/${driveId}/root/children`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":620,"wires":[["89a405ee.0483d8"]],"info":"Enumerate the DriveItem resources in the root of a specific Drive."},{"id":"c5bb4327.73141","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":620,"wires":[["bad86abb.795d98"]]},{"id":"89a405ee.0483d8","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":620,"wires":[["a0952dd9.74054"]]},{"id":"a0952dd9.74054","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":715,"y":620,"wires":[]},{"id":"3903f679.23364a","type":"function","z":"4a045ae1.735204","name":"Request for file","func":"msg.url = `${msg.payload[\"@microsoft.graph.downloadUrl\"]}`\nmsg.method = \"GET\"\n\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":720,"wires":[["962a9f52.93b19"]]},{"id":"962a9f52.93b19","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"bin","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":750,"y":720,"wires":[["4b4bc845.bb0248"]]},{"id":"f948e639.9e10e8","type":"function","z":"4a045ae1.735204","name":"PATCH list item","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\n\nconst driveId = global.get(\"SHAREPOINT_DRIVE_ID\")\n\nconst listId = global.get(\"SHAREPOINT_LIST_ID\")\nconst itemId = global.get(\"SHAREPOINT_LIST_ITEM_ID\")\n\nmsg.url = `${base}/sites/${sharepoint_tenant_url}/lists/${listId}/items/${itemId}/fields`\nmsg.method = \"PATCH\"\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": access_token\n}\nmsg.payload = {\n      \"View\": \"https://docs.microsoft.com/en-us/onedrive/developer/rest-api/api/listitem_update?view=odsp-graph-online\"\n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":460,"wires":[["9031c782.9b1548"]],"info":"Enumerate the DriveItem resources in the root of a specific Drive."},{"id":"a86caa8b.124538","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":460,"wires":[["f948e639.9e10e8"]]},{"id":"9031c782.9b1548","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":460,"wires":[["38377201.9bce8e"]]},{"id":"38377201.9bce8e","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":715,"y":460,"wires":[]},{"id":"78acf9e0.67e5f8","type":"function","z":"4a045ae1.735204","name":"GET list with columns","func":"// https://docs.microsoft.com/en-us/graph/api/resources/drive?view=graph-rest-1.0\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\n\nconst listId = global.get(\"SHAREPOINT_LIST_ID\")\n\nmsg.url = `${base}/sites/${sharepoint_tenant_url}/lists/${listId}/items?expand=fields`\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":420,"wires":[["cb1657be.288ba8"]],"info":"Enumerate the DriveItem resources in the root of a specific Drive."},{"id":"787fd909.32ca68","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":420,"wires":[["78acf9e0.67e5f8"]]},{"id":"cb1657be.288ba8","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":420,"wires":[["790b4a6c.14bdc4"]]},{"id":"790b4a6c.14bdc4","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":715,"y":420,"wires":[]},{"id":"6c4fac84.ac7294","type":"function","z":"4a045ae1.735204","name":"POST create new list","func":"// https://docs.microsoft.com/en-us/onedrive/developer/rest-api/api/list_create?view=odsp-graph-online\n\nconst base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\nconst sharepoint_tenant_url = global.get(\"SHAREPOINT_TENANT_URL\")\n\nmsg.url = `${base}/sites/${sharepoint_tenant_url}/lists`\nmsg.method = \"POST\"\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": access_token\n}\nmsg.payload = {\n  \"displayName\": \"BIMview\",\n  \"columns\": [\n    {\n      \"name\": \"View\",\n      \"text\": { }\n    }\n    ],\n  \"list\": {\n    \"template\": \"DocumentLibrary\"\n  }\n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":380,"wires":[["74b56db1.fb3b04"]],"info":"Enumerate the DriveItem resources in the root of a specific Drive."},{"id":"c04d6f39.c6622","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":380,"wires":[["6c4fac84.ac7294"]]},{"id":"74b56db1.fb3b04","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":555,"y":380,"wires":[["dcf6a0d0.40f9d"]]},{"id":"dcf6a0d0.40f9d","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":715,"y":380,"wires":[]},{"id":"bb81126f.658db","type":"function","z":"4a045ae1.735204","name":"GET /Me (Test)","func":"const base = global.get(\"MICROSOFT_GRAPH_BASE\")\nconst access_token = global.get(\"SHAREPOINT_ACCESS_TOKEN\")\n\nmsg.url = base + \"/me\"\nmsg.method = \"GET\"\nmsg.headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    \"Authorization\": access_token\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":840,"wires":[["3ef08850.b73608"]]},{"id":"a28a85c4.45ff68","type":"inject","z":"4a045ae1.735204","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":840,"wires":[["bb81126f.658db"]]},{"id":"3ef08850.b73608","type":"http request","z":"4a045ae1.735204","name":"","method":"use","ret":"obj","paytoqs":false,"url":"","tls":"","proxy":"","authType":"","x":570,"y":840,"wires":[["cf94eaa8.0dbd48"]]},{"id":"cf94eaa8.0dbd48","type":"debug","z":"4a045ae1.735204","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":730,"y":840,"wires":[]},{"id":"28d4a3cb.f22e3c","type":"comment","z":"4a045ae1.735204","name":"Authentication","info":"","x":130,"y":40,"wires":[]},{"id":"3b8fdf1c.6217d","type":"comment","z":"4a045ae1.735204","name":"Lists/Items","info":"","x":140,"y":260,"wires":[]},{"id":"734578ba.3a1f28","type":"comment","z":"4a045ae1.735204","name":"Drives","info":"","x":130,"y":540,"wires":[]}]